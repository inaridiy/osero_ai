(()=>{"use strict";var t={height:300,width:300,cellSize:15,backgroundColor:"0x008000",colorList:{1:"#000",2:"#fff"}};function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.field=new Array(8).fill(0).map((function(){return new Array(8).fill(0)})),this.rotates=[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]]}var r,i;return r=t,(i=[{key:"canPut",value:function(t,e){var n=this,r=0;return this.rotates.map((function(i,o){var a=n.getTurnCount(t,i,e);r+=a})),r}},{key:"getTurnCount",value:function(t,n,r){for(var i=t.x,o=t.y,a=(v=2,function(t){if(Array.isArray(t))return t}(d=n)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=n){var r,i,o=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){c=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(c)throw i}}return o}}(d,v)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(d,v)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=a[0],f=a[1],l=JSON.stringify(this.field),u=0,s=!1,h=i+c,y=o+f;h<8&&0<=h&&y<8&&0<=y&&this.field[h][y];h+=c,y+=f){if(this.field[h][y]===r){s=!0;break}this.field[h][y]*=-1,u++}var d,v;return u&&(s?this.field[i][o]=r:(this.field=JSON.parse(l),u=0)),u}}])&&n(r.prototype,i),t}();function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.getElementById("oseroCanvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=t.width,this.canvas.height=t.height,this.width=t.width,this.height=t.height,this.setField()}var n,r;return n=e,(r=[{key:"getLocation",value:function(t){var e=t.target.getBoundingClientRect();return{x:Math.floor((t.clientX-e.left)/(this.width/8)),y:Math.floor((t.clientY-e.top)/(this.height/8))}}},{key:"draw",value:function(e){var n=this,r=t.width/8,i=t.height/8;this.setField(),e.forEach((function(e,o){e.forEach((function(e,a){e&&(n.ctx.fillStyle=t.colorList[e]||t.colorList[2],n.ctx.beginPath(),n.ctx.arc(r*(.5+o),i*(.5+a),t.cellSize,0*Math.PI/180,360*Math.PI/180,!1),n.ctx.fill(),n.ctx.closePath())}))}))}},{key:"setField",value:function(){var e=t.width/8,n=t.height/8;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="rgb(0,128,0)",this.ctx.fillRect(0,0,t.width,t.height),this.ctx.lineWidth=2,this.ctx.beginPath();for(var r=1;8>r;r++)this.ctx.moveTo(e*r,0),this.ctx.lineTo(e*r,t.height),this.ctx.moveTo(0,n*r),this.ctx.lineTo(t.width,n*r);this.ctx.closePath(),this.ctx.stroke()}}])&&i(n.prototype,r),e}();function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(s,t);var e,n,r,i,a=(r=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(r);if(i){var n=u(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return l(this,t)});function s(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this)).drawer=new o,t.init(),t.turn=1,t}return e=s,(n=[{key:"init",value:function(){this.field[3][3]=1,this.field[3][4]=-1,this.field[4][3]=-1,this.field[4][4]=1,this.drawer.draw(this.field)}},{key:"put",value:function(t){var e=t.x,n=t.y;if(!this.field[e][n]){var r=JSON.stringify(this.field);this.canPut(t,this.turn)?(this.field[e][n]=this.turn,this.drawer.draw(this.field),this.changeTurn()):this.field=JSON.parse(r)}}},{key:"changeTurn",value:function(){var t=this;this.turn*=-1;var e=JSON.stringify(this.field),n=0,r=0,i=0;if(this.field.forEach((function(o,a){o.forEach((function(o,c){switch(o){case 1:r++;break;case-1:n++;break;case 0:i+=t.canPut({x:a,y:c},t.turn),t.field=JSON.parse(e)}}))})),n+r===64||!r||!n){var o=n===r?"引き分けです":n>r?"白の勝ちです":"黒の勝ちです",a="".concat(n,"対").concat(r,"で");console.log(a+o)}if(!i){this.turn*=-1;var c=1===this.turn?"黒が置けないので白のターンです":"白が置けないので黒のターンです";console.log(c)}}}])&&c(e.prototype,n),s}(r);window.onload=function(){var t=new s;t.drawer.canvas.addEventListener("click",(function(e){var n=t.drawer.getLocation(e);t.put(n)}))}})();